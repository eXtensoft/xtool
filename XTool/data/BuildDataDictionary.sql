


DECLARE @TableName varchar(150)
DECLARE @TableId int
SET		@TableId = 4

SET @TableName = 'Pub_OffRamp'
		INSERT INTO [dbo].[ColumnDefinition] (TableDefinitionId, ColumnName,OrdinalPosition,Datatype,MaxLength,AllowNulls, DefaultValue,IsComputed, IsIdentity,IsPrimaryKey,IsForeignKey)
		SELECT	
			--TABLE_CATALOG AS [Catalog], 
			--TABLE_SCHEMA AS [TableSchema], 
			--TABLE_NAME AS [TableName],
			@TableId AS [TableDefinitionId],			  
			COLUMN_NAME AS [ColumnName],
			ORDINAL_POSITION AS OrdinalPosition,
			DATA_TYPE AS Datatype,
			CHARACTER_MAXIMUM_LENGTH AS MaxLength,
			Convert(bit,(CASE IS_NULLABLE WHEN 'YES' THEN 1 ELSE 0 END)) AS IsNullible,												
			COLUMN_DEFAULT AS DefaultValue,
			Convert(bit,(SELECT COLUMNPROPERTY(OBJECT_ID(@TableName), INFORMATION_SCHEMA.COLUMNS.COLUMN_NAME, 'IsComputed'))) AS IsComputed ,
			Convert(bit,(SELECT COLUMNPROPERTY(OBJECT_ID(@TableName), INFORMATION_SCHEMA.COLUMNS.COLUMN_NAME, 'IsIdentity'))) AS IsIdentity,
			Convert(bit,(ISNULL((SELECT TOP 1 CASE INFORMATION_SCHEMA.TABLE_CONSTRAINTS.CONSTRAINT_TYPE
					WHEN 'PRIMARY KEY' THEN 1
					END
				FROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE INNER JOIN 
					INFORMATION_SCHEMA.TABLE_CONSTRAINTS ON 
					INFORMATION_SCHEMA.KEY_COLUMN_USAGE.CONSTRAINT_NAME=
					INFORMATION_SCHEMA.TABLE_CONSTRAINTS.CONSTRAINT_NAME
				WHERE INFORMATION_SCHEMA.KEY_COLUMN_USAGE.TABLE_NAME = @TableName
					AND INFORMATION_SCHEMA.KEY_COLUMN_USAGE.COLUMN_NAME = 
					INFORMATION_SCHEMA.COLUMNS.COLUMN_NAME
					AND INFORMATION_SCHEMA.TABLE_CONSTRAINTS.CONSTRAINT_TYPE = 'PRIMARY KEY'), 0))) AS IsPrimaryKey,
			Convert(bit,(ISNULL((SELECT TOP 1 CASE INFORMATION_SCHEMA.TABLE_CONSTRAINTS.CONSTRAINT_TYPE
					WHEN 'FOREIGN KEY' THEN 1
					END
				FROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE INNER JOIN 
					INFORMATION_SCHEMA.TABLE_CONSTRAINTS ON 
					INFORMATION_SCHEMA.KEY_COLUMN_USAGE.CONSTRAINT_NAME=
					INFORMATION_SCHEMA.TABLE_CONSTRAINTS.CONSTRAINT_NAME
				WHERE INFORMATION_SCHEMA.KEY_COLUMN_USAGE.TABLE_NAME = @TableName
					AND INFORMATION_SCHEMA.KEY_COLUMN_USAGE.COLUMN_NAME = 
					INFORMATION_SCHEMA.COLUMNS.COLUMN_NAME
					AND INFORMATION_SCHEMA.TABLE_CONSTRAINTS.CONSTRAINT_TYPE = 'FOREIGN KEY'), 0))) AS IsForeignKey

		FROM INFORMATION_SCHEMA.COLUMNS
		WHERE TABLE_NAME = @TableName